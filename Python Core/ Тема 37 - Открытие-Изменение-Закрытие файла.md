#  Тема 37 - Открытие-Изменение-Закрытие файла

## Работа с файлами условно делится на 3 пункта:

- `Открытие файла`
- `Изменение файла`
- `Закрытие файла`
#
Работа с файлами может осуществляться через терминал и через среду разработки (Разбираем на примере PyCharm).

# 1. Терминал
<details>
  <summary>------------------------------------------------</summary>

<details>
  <summary>Расположение файла файла</summary>

- Открытие файла начинается с расположения нужного файла.  
Для того, что бы открыть файл нужно перейти в директорию, в которой этот файл расположен.

<details>
  <summary>Linux:</summary>
    
1. Открыть терминал.
2. Использовать команду `cd (change directory)` с указанием полного или относительного пути к целевой директории. 
```
# Переход в директорию по полному пути
cd /home/ИмяПользователя/Documents

# Переход в директорию по относительному пути
cd ~/Documents
```
#
</details>

<details>
  <summary>Windows:</summary>
  
1. Открыть командную строку `(cmd)` или `PowerShell`.
2. Использовать команду `cd` с указанием полного или относительного пути. 
```
# Переход в директорию по полному пути
cd C:\Users\ИмяПользователя\Documents

# Переход в директорию по относительному пути
cd Documents
```
#
  </details>
  
#
</details>


#
</details>

#


















# 2. PyCham
<details>
  <summary>------------------------------------------------</summary>


<details>
  <summary>Расположение файла</summary>

Что бы открыть файл в PyCharm нужно поместить его в директорию действующего проекта`:

<details>
  <summary>Linux:</summary>
  
1) На Ubuntu:  
- Помести файл `example.txt` внутрь директории проекта `/Home/it_folder/PyCharm_projects/ПоколениеPython_PRO`. Таким образом, структура проекта может выглядеть так:
  
```
/Home/it_folder/PyCharm_projects/ПоколениеPython_PRO
|-- example.txt
|-- другие_файлы_проекта
|-- ...
```
#
</details>

<details>
  <summary>Windows:</summary>
2) На Windows:
- Помести файл `example.txt` внутрь директории проекта `C:\it\JetBrains\PyCharm Projects\Stepik\ПоколениеPython_Pro`. Структура проекта на Windows может быть подобной:

```
C:\it\JetBrains\PyCharm Projects\Stepik\ПоколениеPython_Pro
|-- example.txt
|-- другие_файлы_проекта
|-- ...
```
</details>

</details>

<details>
  <summary>Открытие файла</summary>
  
- `[open('file_name', 'acsess_mode', encoding='utf-8')]` - функция открывающая файл.

     - `['file_name']` - Имя открываемого файла, или путь к нему (Обязательно в кавычках).
     - `['acsess_mode']` - Режим доступа к файлу (по умолчанию 'r'). Это способ, каким ты открываешь файл, чтобы сказать программе, как ты собираешься использовать этот файл.
     - `[encoding='utf-8']`- Указание кодировки файла. РЕКОМНЕНДУЕТСЯ!
 
- При открытии файла функцией `[open()]` в переменную попадает ссылка на файл.
- `[my_file.close()]` - закрывающий метод. При работе с функцией `[open()]` обязателен!
```
my_file = open('example.txt', 'r+')
.
. Здесь происходит изменение файла.
.
my_file.close()
```
- Режимыдоступа к файлу:
```
1) [r] - (read) Только чтение. Файл открытый в таком режиме изменить не получится.
2) [w] - (write) Только запись. Если файл уже существует, стереть его содержимое. Если файл не существует, он будет создан.
3) [a] - (append) Открыть файл для записи. Данные будут добавлены в конец файла. Если файл не существует, он будет создан.
4) [r+] - (read + Write) Открыть файл для чтения и записи. В этом режиме происходит частичная перезапись содержимого файла. Данные в файл, они начинают записываться с той позиции в файле, на которой находится текущий указатель файла (file pointer). Указатель файла устанавливается на начало файла, и если ты пишешь, например, 10 символов, они заменяют первые 10 символов в файле.
5) [x] - Создать новый файл в режиме записи. Если файл существует, произойдет ошибка.
```
#
- Для работы с бинарными файлами используются те же режимы доступа, только с препиской `[b]`

     - `[rb]`, `[wb]`, `[ab]`, `[rb+]`, `[xb]`.
#

## Менеджер контекста

- Конструкция создающая контекст для работы с файлом называется менеджер контекста:

     - `[with]` - ключевое слово, для создания менеджево контекста.
     - `[open()]` - функция открывает файл, и ее результат (файловый объект) присваивается псевдониму (например, file).
     - `[as file]` - Псевдоним (в данном случае file) становится именем, по которому можно обращаться к файловому объекту внутри блока with.
```
with open('example.txt', 'r') as file:
    # Тут выполняются операции с файлом, благодаря контексту
# Файл автоматически закрывается при выходе из блока with
```
- Один и тот же менеджер контекста (with), можно использовать чтобы открывать файл в разных режимах в пределах одного блока кода. После завершения работы с файлом в одном режиме, он закроется, и можно будет снова открыть его в другом режиме в том же блоке with.
```
with open('example.txt', 'r') as file:
    content = file.read()
    print(content)

with open('example.txt', 'a') as file:
    file.write('\nNew line added')

with open('example.txt', 'r') as file:
    updated_content = file.read()
    print(updated_content)
```
</details>
<details>
  <summary>Изменение файла</summary>

## Чтение файла
- При открытии файла функцией `[open()]` в переменную попадает ссылка на файл.
- Для чтения содержимого открытого для чтения файла используются три файловых метода:

1) `[read(size=-1)]` - Читает из файла определенное количество байт (если size указан) или весь файл (если size не указан или равен -1). Возвращает считанные данные в виде строки. Перемещает указатель файла в конец прочитанных данных. 
3) `[readline()]` - читает строку, на которой установлена "каретка" (или указатель файла) в данный момент. Перемещает указатель файла на следующую строку. 
4) `[readlines()]` - считывает все строки из файла и возвращает список из всех считанных строк (одна строка — один элемент списка). При этом, каждая строка в списке заканчивается символом переноса строки  `['\n']`
#
## Запись данных в файл

- Для записи данных в файл используется два метода:

1) `[write()]` - Записывает строку в файл. Если файл открыт в режиме 'w', это перезапишет содержимое файла. Если файл открыт в режиме 'a', это добавит строку в конец файла (В конец последней строки).
```
with open('example.txt', 'w') as file:
    file.write('Hello, World!')
```
2) `[writelines()]` - Записывает список строк в файл. Если файл открыт в режиме 'w', то метод writelines перезапишет содержимое файла списком строк. Если файл открыт в режиме 'a', то добавит список строк в конец файла, при этом каждая строка будет добавлена как новая строка в файле, а не в конец последней строки.
```
with open('example.txt', 'w') as file:
    lines = ['Line 1\n', 'Line 2\n', 'Line 3\n']
    file.writelines(lines)
```
#
## Запись в файл с помощью функции print()
- Для записи данных в файл можно также использовать встроенную функцию print(). Для этого нужно передать ей еще один именованный аргумент file, указывающий на открытый файл. При этом функция print() автоматически добавляет переход на новую строку.
```
with open('example.txt', 'a') as file:
    print('Джoн Локк', file=file)
    print('Дэвид Хьюм', file=file)
    print('Эдмyнд Берк', file=file)
```
  
</details>


</details>

</details>



#

# Закрытие файла
<details>
 <summary>------------------------------------------------</summary>

- Закрытие файла происходит либо автоматически, используя менеджер контекста.
- Либо принудительно, при помощи метода `[file.close()]` по окончании работы с файлом

</details>

#









# Файловые методы
<details>
 <summary>------------------------------------------------</summary>

1) `[file = open(file, mode='r', encoding=None)]` - используется для открытия файла в Python. Вот его общее определение:
```
with open('example.txt', 'r', newline='\n') as file:
    print(file.read())
```
#
2) `[file.close()]` - используется для закрытия открытого файла в Python. Конструкция With закрывает файл автоматически.
```
# Открываем файл для чтения
file = open('example.txt', 'r', encoding='utf-8')

# Читаем содержимое файла
content = file.read()
print(content)

# Закрываем файл после использования
file.close()
```
#
3) `[file.next()]` - используется для чтения следующей строки из файла.
```
# Открываем файл для чтения
with open('example.txt', 'r', encoding='utf-8') as file:
    
    # Читаем первую строку
    line1 = next(file)
    print("Первая строка:", line1)
    
    # Читаем вторую строку
    line2 = next(file)
    print("Вторая строка:", line2)
```
#
4) `[read(size=-1)]` - Читает из файла определенное количество байт (если size указан) или весь файл (если size не указан или равен -1). Возвращает считанные данные в виде строки. Перемещает указатель файла в конец прочитанных данных.
#
5) `[readline()]` - читает строку, на которой установлена "каретка" (или указатель файла) в данный момент. Перемещает указатель файла на следующую строку.
#
6) `[readlines()]` - считывает все строки из файла и возвращает список из всех считанных строк (одна строка — один элемент списка). При этом, каждая строка в списке заканчивается символом переноса строки  `['\n']`
#
7) `[write()]` - Записывает строку в файл. Если файл открыт в режиме 'w', это перезапишет содержимое файла. Если файл открыт в режиме 'a', это добавит строку в конец файла (В конец последней строки).
```
with open('example.txt', 'w') as file:
    file.write('Hello, World!')
```
8) `[writelines()]` - Записывает список строк в файл. Если файл открыт в режиме 'w', то метод writelines перезапишет содержимое файла списком строк. Если файл открыт в режиме 'a', то добавит список строк в конец файла, при этом каждая строка будет добавлена как новая строка в файле, а не в конец последней строки.
```
with open('example.txt', 'w') as file:
    lines = ['Line 1\n', 'Line 2\n', 'Line 3\n']
    file.writelines(lines)
```
#
9) `[file.seek(n)]` - перемещает каретку в указанное по счету симфолов место.
```
with open(example.txt', 'r', encoding='utf-8') as file:
    
    # Читаем первые 10 символов
    content_part1 = file.read(10)
    print("Прочитано первых 10 символов:", content_part1)
    
    # Перемещаем указатель на начало файла
    file.seek(0)
```
#
10) `[file.tell()]` - Возвращает текущую позицию указателя чтения/записи в файле в байтах.
#
11) `[file.fileno()]` - возвращает целочисленный файловый дескриптор (file descriptor), связанный с открытым файлом. Файловый дескриптор представляет собой уникальный идентификатор файла в системе.
```
file_path = 'example.txt'

with open(file_path, 'r', encoding='utf-8') as file:
    
    # Получаем файловый дескриптор
    file_descriptor = file.fileno()
    print("Файловый дескриптор:", file_descriptor)
```
#
</details>
